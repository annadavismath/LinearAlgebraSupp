\documentclass{ximera}
\input{../preamble.tex}

\title{$LU$-factorization} \license{CC BY-NC-SA 4.0}
\begin{document}
\begin{abstract}
\end{abstract}
\maketitle

\section*{$LU$-factorization}

This section provides a template for performing $LU$-factorization.  You can access our Octave code through the link at the bottom of the template.  Feel free to modify the code and experiment to learn more!  Alternatively, go to the \href{https://sagecell.sagemath.org/}{Sage Math Cell Webpage}, copy the code below into the cell, select OCTAVE as the language, and press EVALUATE. 

Before we proceed with the code, recall that if the elementary matrices used to reduce the given matrix to row-echelon form are all lower triangular, then we can find an $LU$ factorization.  In general, the following theorem applies.

\begin{theorem}[\ref{th:LUPA}]
Suppose an $m \times n$ matrix $A$ is transformed to a row-echelon matrix $U$ using Gaussian elimination. Let $P_1, P_2, \ldots, P_s$ be the elementary matrices corresponding (in order) to the row interchanges used,
and write $P=P_s \cdots P_2 P_1$. (If no interchanges are used take $P = I$.) Then:
\begin{enumerate}
\item $PA$ is the matrix obtained from $A$ by doing these interchanges (in order) to A.
\item $PA$ has an $LU$ factorization.
\end{enumerate}
\end{theorem}

\begin{template}\label{temp:LU}
We can find $LU$-factorization of a matrix as follows.  

\begin{verbatim}
% Define matrix A
A=[2 2 -1 2;
   -1 2 2 1;
   1 2 0 -2;
   1 1 -2 -4];
   
% Find LU factorization for A   
[L, U, P] = lu (A)
% where L is a lower triangular matrix,
% U is an upper triangular matrix, and
% P is an appropriate permutation matrix

% Verify that this factorization is correct
productLU=L*U
productPA=P*A
\end{verbatim}

\href{https://sagecell.sagemath.org/?z=eJxtjrFqwzAURXeB_-EugTbYEJtuxYOgdNLgRV1CBmHLjcCRxKtEmn59n-y0UCgC8Y507uPu8GJn5y0uJpH7hKyE7I8dOjQtuudKAOvEp92owAFN90Mtz2ieThtXYodX5ycojdmMKZD7MskFjzkQ5GocVQ1dYzihx5LxIB9L6nq2ZKHgPmCwhKslcCPj3_Ni6F6vLqJeFY8c478O_03FG-6eiZFCZC1ZcOKS01Zo0ytR3DdLbr4hnU3ii3N_u_PDGIjsmCrBy6Y8JqV7tde_OMh-2Mtvdaxh4w==&lang=octave&interacts=eJyLjgUAARUAuQ==}{Link to code}.

\begin{remark}
\begin{itemize}
\item Observe that the permutation matrix $P$ is not the identity matrix.  What elementary row operation does multiplication by $P$ induce?
    \item With the last two lines of our code we checked the correctness of our factorization.  Is it true that $PA=LU$?  Interpret the value $-2.77556e-17$ in the product $LU$.  What do you think caused this value to occur?  
\end{itemize}
    \end{remark}
    
\end{template}

\end{document}